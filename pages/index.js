import Head from "next/head"
import ImageGrid from "../components/ImageGrid"
import Hero from "../components/Hero"
import { collection, getDocs, query, orderBy } from "firebase/firestore"
import { db } from "../public/firebase/firebase"
import BackToTop from "../components/BackToTop"

export default function Home({ imgList }) {
	return (
		<div>
			<Head>
				<title>Create Next App</title>
				<meta
					name="description"
					content="Generated by create next app"
				/>
				<link rel="icon" href="/favicon.ico" />
			</Head>
			<BackToTop></BackToTop>
			<Hero></Hero>
			<ImageGrid imgList={imgList}></ImageGrid>
		</div>
	)
}

export const getServerSideProps = async (context) => {
	let list = []
	try {
		const q = query(collection(db, "slike"), orderBy("date"))
		const querySnapshot = await getDocs(q)
		querySnapshot.forEach((doc) => {
			list.push({ id: doc.id, ...doc.data() })
		})

		return {
			props: { imgList: list },
		}
	} catch (err) {
		console.log(err)
		return { props: {} }
	}
}
